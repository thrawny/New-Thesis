\chapter{Results}
\label{chap:results}

In this chapter we present results from the evaluation phase.

\section{Data separation}
Not written yet.

\section{Query support}
The set of important queries defined in table~\ref{tab:queries} has been implemented for both archive prototypes. Results from the first iteration are presented in table~\ref{tab:archivequeries}. These are just the initial presentation of the results.
\begin{table}[h]
\begin{tabular}{|l|l|l|}
\hline
\textbf{High level query}                & \textbf{Supported} & \textbf{Comment}           \\ \hline
Get build                                    & Y                                                                                        &                            \\ \hline
Get build information                        & Y                                                                                        &                            \\ \hline
Get build for root test suite                & Y                                                                                        &                            \\ \hline
Get trouble reports for build                & Y                                                                                        &                            \\ \hline
Get trouble report fixes for build           & Y                                                                                        &                            \\ \hline
Get trouble reports for product and revision & Y                                                                                        &                            \\ \hline
Get test suite children                      & Y                                                                                        &                            \\ \hline
Get test case in build                       & Y                                                                                        &                            \\ \hline
Get test suite in build                      & Y                                                                                        &                            \\ \hline
Get root test suite for test case/test suite & Y                                                                                        &                            \\ \hline
Get test case by name                        & Y                                                                                        & Used for test case history \\ \hline
Get test suite for test case                 & Y                                                                                        &                            \\ \hline
Get test case history                        & P                                                                                        & Tags not supported         \\ \hline
Get test tree                                & P                                                                                        & Runs slow for large trees  \\ \hline
\end{tabular}
\caption{Possible values in the supported column are yes/no/partially.}
\label{tab:archivequeries}
\end{table}

%\section{Schema evolution}
%Not yet addressed

\section{Scalability}
\subsection{Disk usage}
Disk usage after migration of live databases of different sizes are presented in figure~\ref{fig:disc}. Migrations with data sets of around 2 billion and 3 billion job events have been performed.  
\begin{figure}[h!]
\centering
\begin{tikzpicture}
\begin{axis}[
    ybar,
    enlargelimits=0.15,
    legend style={at={(0.5,-0.2)},
      anchor=north,legend columns=-1, },
    xlabel={Job Events (Billion)},
    ylabel={Disk Usage (GB)},
    symbolic x coords={480,3300},
    xtick=data,
    nodes near coords,
    nodes near coords align={vertical},
    ]
\addplot coordinates {(480,1) (3300,165)};
\addplot coordinates {(480,1) (3300,225)};
\addplot coordinates {(480,259) (3300,1553)};
\legend{MongoDB,ElasticSearch,MySQL}
\end{axis}
\end{tikzpicture}
\caption{Disk usage}
\label{fig:disc}
\end{figure}
\subsection{Memory utilization}
Working set estimations are presented in figure~\ref{fig:ws}. We have done initial estimations of the working set for MongoDB with manual testing. As long as custom indexes defined on the job event collection fit in RAM, the database is stable and can respond to queries where indexes can be utilized. The working set estimation is the summed size of the custom indexes.
\begin{figure}[h!]
\centering
\begin{tikzpicture}
\begin{axis}[
    ybar,
    enlargelimits=0.15,
    legend style={at={(0.5,-0.2)},
      anchor=north,legend columns=-1, },
    xlabel={Job Events (Billion)},
    ylabel={Memory Utilization (GB)},
    symbolic x coords={2,3.3},
    xtick=data,
    nodes near coords,
    nodes near coords align={vertical},
    ]
\addplot coordinates {(2,6) (3.3,12)};
\addplot coordinates {(2,1) (3.3,1)};
\addplot coordinates {(2,1) (3.3,1)};
\legend{MongoDB,ElasticSearch,MySQL}
\end{axis}
\end{tikzpicture}
\caption{Working set estimation}
\label{fig:ws}
\end{figure}
\subsection{Insertion time}
Not yet addressed
\subsection{Horizontal Scalability}
Not yet addressed
H채r borde vi kunna skriva tekniska saker, men fr책n de tekniska saker dra slutsater i Discussion som svarar p책 om dessa tekniker ger n책got business value?
\hiddensubsubsection{MongoDB}
\hiddensubsubsection{Elasticsearch}
Lessons learned while scaling with Elasticsearch, an empirical study.\\
Compared to MongoDB, horizontal scaling with Elasticsearch demands more configuration upfront in order to get a suitable cluster. 
In MongoDB, where the process of adding new nodes to a cluster is not limited on how the initial node is configured, the maximum number of nodes in an Elasticsearch cluster must be known on beforehand. This restriction depends on how elasticsearch is scaling in an horizontal manner. The partitioning of data when adding new nodes to a cluster is dependent on how many shards the initial node holds, as an new is added to the cluster
the number of nodes in a cluster can never exceed the number of shards in the opening node. 

\hiddensubsubsection{TokuDB}
\section{Organizational suitability}
This section describes the organizational suitability of the different artifacts.
\hiddensubsection{MongoDB}
\hiddensubsection{Elasticsearch}
\hiddensubsection{TokuDB}